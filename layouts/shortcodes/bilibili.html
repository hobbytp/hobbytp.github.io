{{/*
Bç«™è§†é¢‘Shortcode

ä½¿ç”¨æ–¹æ³•:
{{< bilibili BV1xx411x7x7 >}}
{{< bilibili id="BV1xx411x7x7" >}}
{{< bilibili id="BV1xx411x7x7" title="è§†é¢‘æ ‡é¢˜" >}}
{{< bilibili id="BV1xx411x7x7" autoplay="true" >}}
*/}}

{{ $id := .Get 0 }}
{{ if .Get "id" }}
  {{ $id = .Get "id" }}
{{ end }}

{{ if $id }}
  {{/* æå–Bç«™è§†é¢‘IDï¼Œæ”¯æŒBVå’ŒAVå· */}}
  {{ $videoId := $id }}

  {{/* Bç«™iframeåµŒå…¥ä»£ç  */}}
  <div class="bilibili-video-wrapper" style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
    <iframe
      src="https://player.bilibili.com/player.html?bvid={{ $videoId }}&autoplay=0&danmaku=0&high_quality=1"
      style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 8px;"
      allowfullscreen="true"
      sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups">
    </iframe>
  </div>

  {{/* å¯é€‰çš„è§†é¢‘ä¿¡æ¯æ˜¾ç¤º */}}
  {{ if .Get "title" }}
    <p class="bilibili-video-title" style="margin-top: 0.5rem; font-size: 0.9rem; color: #666; text-align: center;">
      ğŸ“º {{ .Get "title" }}
    </p>
  {{ end }}

  {{/* é“¾æ¥åˆ°åŸå§‹è§†é¢‘ */}}
  <p class="bilibili-video-link" style="margin-top: 0.25rem; font-size: 0.8rem; color: #999; text-align: center;">
    <a href="https://www.bilibili.com/video/{{ $videoId }}" target="_blank" rel="noopener noreferrer" style="color: #00a1d6; text-decoration: none;">
      ğŸ”— åœ¨Bç«™è§‚çœ‹å®Œæ•´è§†é¢‘
    </a>
  </p>

{{ else }}
  {{ errorf "bilibili shortcode: ç¼ºå°‘è§†é¢‘IDå‚æ•°" }}
{{ end }}

<style>
/* å“åº”å¼è§†é¢‘å®¹å™¨ */
@media (max-width: 768px) {
  .bilibili-video-wrapper {
    padding-bottom: 75%; /* ç§»åŠ¨ç«¯æ›´å®½çš„çºµæ¨ªæ¯” */
  }
}

/* æš—è‰²æ¨¡å¼æ”¯æŒ */
@media (prefers-color-scheme: dark) {
  .bilibili-video-title {
    color: #ccc !important;
  }

  .bilibili-video-link {
    color: #aaa !important;
  }

  .bilibili-video-link a {
    color: #4fc3f7 !important;
  }
}

/* æ‰“å°æ ·å¼ */
@media print {
  .bilibili-video-wrapper {
    display: none;
  }

  .bilibili-video-title,
  .bilibili-video-link {
    display: block;
    background: #f0f0f0;
    padding: 1rem;
    border-radius: 4px;
    font-size: 12pt;
  }
}
</style>
