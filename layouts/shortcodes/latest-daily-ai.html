{{/* latest-daily-ai shortcode - æ˜¾ç¤ºæœ€æ–°çš„æ¯æ—¥AIåŠ¨æ€ */}}
{{ $dailyAIPath := "content/zh/daily_ai" }}
{{ $dailyAIFiles := readDir $dailyAIPath }}

{{/* è·å–æ‰€æœ‰æ—¥æœŸæ–‡ä»¶ï¼Œæ’é™¤_index.md */}}
{{ $dateFiles := slice }}
{{ range $dailyAIFiles }}
  {{ if and (not (eq .Name "_index.md")) (strings.HasSuffix .Name ".md") }}
    {{ $dateFiles = $dateFiles | append .Name }}
  {{ end }}
{{ end }}

{{/* æŒ‰æ—¥æœŸæ’åºï¼Œè·å–æœ€æ–°çš„æ–‡ä»¶ */}}
{{ $sortedFiles := sort $dateFiles "value" "desc" }}
{{ $latestFile := index $sortedFiles 0 }}

{{ if $latestFile }}
  {{ $latestPath := printf "%s/%s" $dailyAIPath $latestFile }}
  {{ $latestContent := readFile $latestPath }}
  
  {{/* è§£æfront matterå’Œå†…å®¹ */}}
  {{ $parts := split $latestContent "---" }}
  {{ if ge (len $parts) 3 }}
    {{ $frontMatter := index $parts 1 }}
    {{ $content := index $parts 2 }}
    
    {{/* æå–æ—¥æœŸå’Œæ ‡é¢˜ */}}
    {{ $date := "" }}
    {{ $title := "" }}
    {{ range (split $frontMatter "\n") }}
      {{ if strings.HasPrefix . "date:" }}
        {{ $date = strings.TrimPrefix "date:" . | strings.TrimSpace }}
      {{ else if strings.HasPrefix . "title:" }}
        {{ $title = strings.TrimPrefix "title:" . | strings.TrimSpace }}
      {{ end }}
    {{ end }}
    
    <div class="latest-daily-ai">
      <div class="daily-ai-header">
        <h3>ğŸ“… {{ $title | default "æ¯æ—¥AIåŠ¨æ€" }}</h3>
        <p class="daily-ai-date">{{ $date }}</p>
      </div>
      
      <div class="daily-ai-content">
        {{ $content | markdownify }}
      </div>
      
      <div class="daily-ai-footer">
        <a href="/zh/daily_ai" class="view-all-link">æŸ¥çœ‹æ‰€æœ‰åŠ¨æ€ â†’</a>
      </div>
    </div>
  {{ else }}
    <div class="latest-daily-ai">
      <p>æš‚æ— æ¯æ—¥AIåŠ¨æ€å†…å®¹</p>
    </div>
  {{ end }}
{{ else }}
  <div class="latest-daily-ai">
    <p>æš‚æ— æ¯æ—¥AIåŠ¨æ€å†…å®¹</p>
  </div>
{{ end }}

<style>
.latest-daily-ai {
  background: var(--color-bg-secondary, #f8fafc);
  border: 1px solid var(--color-border-light, #e2e8f0);
  border-radius: 12px;
  padding: 1.5rem;
  margin: 1.5rem 0;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.daily-ai-header {
  border-bottom: 1px solid var(--color-border-light, #e2e8f0);
  padding-bottom: 1rem;
  margin-bottom: 1rem;
}

.daily-ai-header h3 {
  margin: 0 0 0.5rem 0;
  color: var(--color-primary, #1e40af);
  font-size: 1.25rem;
  font-weight: 600;
}

.daily-ai-date {
  margin: 0;
  color: var(--color-text-secondary, #6b7280);
  font-size: 0.9rem;
}

.daily-ai-content {
  line-height: 1.6;
  color: var(--color-text-primary, #1f2937);
}

.daily-ai-content h4 {
  color: var(--color-primary, #1e40af);
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}

.daily-ai-content ul {
  margin: 0.75rem 0;
  padding-left: 1.5rem;
}

.daily-ai-content li {
  margin: 0.5rem 0;
}

.daily-ai-footer {
  border-top: 1px solid var(--color-border-light, #e2e8f0);
  padding-top: 1rem;
  margin-top: 1rem;
  text-align: right;
}

.view-all-link {
  color: var(--color-primary, #1e40af);
  text-decoration: none;
  font-weight: 500;
  transition: color 0.2s ease;
}

.view-all-link:hover {
  color: var(--color-primary-dark, #1e3a8a);
  text-decoration: underline;
}

/* æš—è‰²æ¨¡å¼é€‚é… */
.dark .latest-daily-ai {
  background: var(--color-dark-bg-secondary, #1f2937);
  border-color: var(--color-dark-border, #374151);
  color: var(--color-dark-text-primary, #f9fafb);
}

.dark .daily-ai-header {
  border-bottom-color: var(--color-dark-border, #374151);
}

.dark .daily-ai-header h3 {
  color: var(--color-primary-light, #60a5fa);
}

.dark .daily-ai-date {
  color: var(--color-dark-text-secondary, #9ca3af);
}

.dark .daily-ai-content {
  color: var(--color-dark-text-primary, #f9fafb);
}

.dark .daily-ai-content h4 {
  color: var(--color-primary-light, #60a5fa);
}

.dark .daily-ai-footer {
  border-top-color: var(--color-dark-border, #374151);
}

.dark .view-all-link {
  color: var(--color-primary-light, #60a5fa);
}

.dark .view-all-link:hover {
  color: var(--color-primary, #3b82f6);
}
</style>
