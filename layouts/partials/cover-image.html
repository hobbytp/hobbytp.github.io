{{- /*
AI Cover Image Generator - HugoåŸç”Ÿå®ç°
åŸºäºæ–‡ç« titleå’Œdescriptionè‡ªåŠ¨ç”ŸæˆCSSè‰ºæœ¯å°é¢
*/ -}}
{{- $title := .Title -}}
{{- $description := .Description | default .Summary -}}
{{- $category := "" -}}
{{- with .Params.categories -}}
  {{- $category = index . 0 -}}
{{- end -}}

{{- /* ç”Ÿæˆå”¯ä¸€ID */ -}}
{{- $contentHash := printf "%s|%s" $title $description | strings.Truncate 100 -}}
{{- $imageId := printf "cover-%s" (replace $contentHash " " "-" | replace ":" "-" | replace "." "-" | replace "/" "-") -}}
{{- $imageId = $imageId | lower | truncate 20 "" -}}

{{- /* å¦‚æœå·²æœ‰å°é¢å›¾ç‰‡ï¼Œç›´æ¥ä½¿ç”¨ */ -}}
{{- $coverImage := "" }}
{{- if .Params.cover.image }}
  {{- $coverImage = .Params.cover.image }}
{{- else if .Params.image }}
  {{- $coverImage = .Params.image }}
{{- else if .Params.ai_cover }}
  {{- $coverImage = .Params.ai_cover }}
{{- end }}

{{- /* è½¬æ¢Windowsè·¯å¾„ä¸ºwebè·¯å¾„ */ -}}
{{- $webPath := replace $coverImage "\\" "/" -}}

{{- if $coverImage }}
  {{- if eq .Params.ai_generated true -}}
  <img src="{{ $webPath | absURL }}" alt="{{ .Params.cover.alt | default $title }}" loading="lazy" class="ai-generated">
    <div class="ai-generated-badge">ğŸ¤– AIç”Ÿæˆ</div>
{{- else }}
  <img src="{{ $webPath | absURL }}" alt="{{ .Params.cover.alt | default $title }}" loading="lazy">
{{- end }}
{{- else -}}
  {{- /* ç”ŸæˆCSSè‰ºæœ¯å°é¢ */ -}}
  <div class="ai-generated-cover category-{{ $category | lower }}" id="{{ $imageId }}" style="--base-hue: {{ mod (len $title) 360 }};">
    <div class="cover-content">
      <div class="cover-category">{{ $category }}</div>
      <h3 class="cover-title">{{ $title }}</h3>
      <div class="cover-description">{{ $description | strings.Truncate 120 }}</div>
    </div>
  </div>
{{- end -}}