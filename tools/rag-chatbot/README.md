# Hugo Blog RAG Chatbot

åŸºäºRetrieval-Augmented Generationçš„æ™ºèƒ½åšå®¢é—®ç­”ç³»ç»Ÿï¼Œä¸ºHugoåšå®¢æä¾›AIé©±åŠ¨çš„æ™ºèƒ½é—®ç­”åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ§  **æ™ºèƒ½é—®ç­”**: åŸºäºåšå®¢å†…å®¹è¿›è¡Œè¯­ä¹‰æœç´¢å’Œæ™ºèƒ½å›ç­”
- ğŸ” **å‘é‡æ£€ç´¢**: ä½¿ç”¨Sentence Transformerså’ŒFAISSè¿›è¡Œé«˜æ•ˆå‘é‡æœç´¢
- ğŸ¤– **AIå¢å¼º**: æ”¯æŒOpenAI GPTé›†æˆï¼Œæä¾›æ›´æ™ºèƒ½çš„å›ç­”
- ğŸ“š **å†…å®¹ç´¢å¼•**: è‡ªåŠ¨ç´¢å¼•æ‰€æœ‰åšå®¢æ–‡ç« ï¼Œæ”¯æŒå¢é‡æ›´æ–°
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡å†…å®¹ç†è§£
- âš¡ **å®æ—¶æ›´æ–°**: æ”¯æŒå†…å®¹æ›´æ–°æ—¶çš„ç´¢å¼•å¢é‡æ›´æ–°

## å·¥ä½œåŸç†

### RAG (Retrieval-Augmented Generation) æµç¨‹

1. **æ–‡æ¡£å¤„ç†**: è§£æHugo Markdownæ–‡ä»¶ï¼Œæå–çº¯æ–‡æœ¬å†…å®¹
2. **æ–‡æœ¬åˆ†å—**: å°†é•¿æ–‡æ¡£åˆ†å‰²æˆè¯­ä¹‰ç›¸å…³çš„æ–‡æœ¬å—
3. **å‘é‡åµŒå…¥**: ä½¿ç”¨Sentence Transformerså°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡
4. **ç´¢å¼•æ„å»º**: ä½¿ç”¨FAISSæ„å»ºå‘é‡ç´¢å¼•ï¼Œæ”¯æŒå¿«é€Ÿç›¸ä¼¼åº¦æœç´¢
5. **æ£€ç´¢å¢å¼º**: ç”¨æˆ·æŸ¥è¯¢æ—¶æ£€ç´¢æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µ
6. **ç­”æ¡ˆç”Ÿæˆ**: åŸºäºæ£€ç´¢ç»“æœç”Ÿæˆå‡†ç¡®ã€ç›¸å…³çš„å›ç­”

### ç³»ç»Ÿæ¶æ„

```
ç”¨æˆ·æŸ¥è¯¢ â†’ å‘é‡åµŒå…¥ â†’ FAISSæ£€ç´¢ â†’ ç›¸å…³æ–‡æ¡£ â†’ AIç”Ÿæˆ â†’ æ™ºèƒ½å›ç­”
                       â†“
                  åšå®¢å†…å®¹ç´¢å¼•
```

## å®‰è£…ä¾èµ–

```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# æˆ–ä½¿ç”¨conda
conda install numpy sentence-transformers faiss-cpu beautifulsoup4 markdown
pip install openai
```

## å¿«é€Ÿå¼€å§‹

### 1. æ„å»ºå†…å®¹ç´¢å¼•

```bash
# é¦–æ¬¡æ„å»ºç´¢å¼•
python rag_engine.py --rebuild-index

# æ›´æ–°ç°æœ‰ç´¢å¼•ï¼ˆå¢é‡ï¼‰
python rag_engine.py --update-index
```

### 2. æµ‹è¯•é—®ç­”åŠŸèƒ½

```bash
# ç®€å•æŸ¥è¯¢æµ‹è¯•
python rag_engine.py --query "ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ï¼Ÿ"

# å¤æ‚é—®é¢˜
python rag_engine.py --query "å¦‚ä½•ä½¿ç”¨AIè¿›è¡Œä»£ç ç”Ÿæˆï¼Ÿ"
```

### 3. æŸ¥çœ‹ç´¢å¼•ç»Ÿè®¡

```bash
python rag_engine.py --stats
```

## å‘½ä»¤è¡Œé€‰é¡¹

| é€‰é¡¹ | æè¿° | é»˜è®¤å€¼ |
|------|------|--------|
| `--content-dir DIR` | Hugoå†…å®¹ç›®å½• | `content` |
| `--index-dir DIR` | ç´¢å¼•å­˜å‚¨ç›®å½• | `rag-index` |
| `--rebuild-index` | å®Œå…¨é‡å»ºç´¢å¼• | - |
| `--update-index` | å¢é‡æ›´æ–°ç´¢å¼• | - |
| `--query TEXT` | æ‰§è¡ŒæŸ¥è¯¢ | - |
| `--serve` | å¯åŠ¨WebæœåŠ¡ | - |
| `--stats` | æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ | - |
| `--openai-api-key KEY` | OpenAI APIå¯†é’¥ | ç¯å¢ƒå˜é‡ |
| `--embedding-model MODEL` | åµŒå…¥æ¨¡å‹åç§° | `all-MiniLM-L6-v2` |

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

```bash
# è®¾ç½®OpenAI APIå¯†é’¥
export OPENAI_API_KEY="your-api-key-here"
```

### è‡ªå®šä¹‰é…ç½®

```python
# åœ¨rag_engine.pyä¸­ä¿®æ”¹é…ç½®
self.chunk_size = 1000      # æ–‡æœ¬å—å¤§å°
self.chunk_overlap = 200    # å—é‡å å¤§å°
self.embedding_model_name = "paraphrase-multilingual-MiniLM-L12-v2"  # å¤šè¯­è¨€æ¨¡å‹
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬æŸ¥è¯¢

```bash
# å…³äºAIçš„è¯é¢˜
python rag_engine.py --query "AIåœ¨è½¯ä»¶å¼€å‘ä¸­çš„åº”ç”¨"

# å…·ä½“æŠ€æœ¯é—®é¢˜
python rag_engine.py --query "å¦‚ä½•ä¼˜åŒ–Reactåº”ç”¨çš„æ€§èƒ½"

# å†…å®¹åˆ›ä½œå»ºè®®
python rag_engine.py --query "å†™æŠ€æœ¯åšå®¢çš„ç»éªŒåˆ†äº«"
```

### ç´¢å¼•ç®¡ç†

```bash
# æŸ¥çœ‹å½“å‰ç´¢å¼•çŠ¶æ€
python rag_engine.py --stats

# é‡å»ºç´¢å¼•ï¼ˆæ·»åŠ æ–°å†…å®¹åï¼‰
python rag_engine.py --rebuild-index

# å¢é‡æ›´æ–°ï¼ˆåªå¤„ç†å˜æ›´å†…å®¹ï¼‰
python rag_engine.py --update-index
```

## è¾“å‡ºç¤ºä¾‹

### æŸ¥è¯¢ç»“æœ

```
ğŸ” æŸ¥è¯¢: ä»€ä¹ˆæ˜¯RAGï¼Ÿ

ğŸ¤– å›ç­”:
RAGï¼ˆRetrieval-Augmented Generationï¼‰æ˜¯ä¸€ç§ç»“åˆæ£€ç´¢å’Œç”Ÿæˆçš„AIæŠ€æœ¯ã€‚å®ƒé€šè¿‡é¦–å…ˆä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œç„¶ååŸºäºè¿™äº›ä¿¡æ¯ç”Ÿæˆå›ç­”ï¼Œä»è€Œæä¾›æ›´å‡†ç¡®ã€æ›´æœ‰æ ¹æ®çš„å›ç­”ã€‚

ğŸ“š ç›¸å…³æ¥æº:
1. AIæŠ€æœ¯åŸºç¡€ (ç›¸å…³åº¦: 0.823)
   /zh/ai-basics/
2. å¤§è¯­è¨€æ¨¡å‹è¿›é˜¶ (ç›¸å…³åº¦: 0.756)
   /zh/llm-advanced/
```

### ç»Ÿè®¡ä¿¡æ¯

```
ğŸ“Š RAGç´¢å¼•ç»Ÿè®¡ä¿¡æ¯:
- æ–‡æ¡£å—æ•°é‡: 1247
- å‘é‡ç»´åº¦: 384
- æ€»è¯æ•°: 89,432
- å”¯ä¸€æ–‡ä»¶æ•°: 234
- æœ€åæ›´æ–°: 2025-11-01T00:15:30
```

## é›†æˆåˆ°Hugoå·¥ä½œæµ

### Makefileé›†æˆ

```makefile
# RAGç›¸å…³ç›®æ ‡
rag-build-index:
	@echo "ğŸ§  æ„å»ºRAGç´¢å¼•..."
	@cd tools/rag-chatbot && $(PYTHON_CMD) rag_engine.py --rebuild-index

rag-update-index:
	@echo "ğŸ”„ æ›´æ–°RAGç´¢å¼•..."
	@cd tools/rag-chatbot && $(PYTHON_CMD) rag_engine.py --update-index

rag-query:
	@echo "ğŸ¤– RAGæŸ¥è¯¢æµ‹è¯•..."
	@cd tools/rag-chatbot && $(PYTHON_CMD) rag_engine.py --query "$(QUERY)"

# å®Œæ•´æ„å»ºåŒ…å«RAG
full-build: build rag-update-index
```

### ä½¿ç”¨æ–¹æ³•

```bash
# æ„å»ºç´¢å¼•
make rag-build-index

# æ›´æ–°ç´¢å¼•
make rag-update-index

# æµ‹è¯•æŸ¥è¯¢
make rag-query QUERY="ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ"
```

## é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰åµŒå…¥æ¨¡å‹

```python
# ä½¿ç”¨å¤šè¯­è¨€æ¨¡å‹
self.embedding_model_name = "paraphrase-multilingual-MiniLM-L12-v2"

# ä½¿ç”¨æ›´ç²¾ç¡®çš„æ¨¡å‹
self.embedding_model_name = "all-mpnet-base-v2"
```

### æ–‡æœ¬åˆ†å—ç­–ç•¥

```python
# è°ƒæ•´åˆ†å—å‚æ•°
self.chunk_size = 800       # æ›´å°çš„å—
self.chunk_overlap = 150    # æ›´å°‘çš„é‡å 
```

### æ£€ç´¢ä¼˜åŒ–

```python
# è°ƒæ•´æ£€ç´¢å‚æ•°
top_k = 10  # è¿”å›æ›´å¤šå€™é€‰æ–‡æ¡£
score_threshold = 0.7  # è®¾ç½®ç›¸ä¼¼åº¦é˜ˆå€¼
```

## æ€§èƒ½ä¼˜åŒ–

- **ç´¢å¼•å‹ç¼©**: FAISSæ”¯æŒå¤šç§ç´¢å¼•ç±»å‹ï¼Œå¯æ ¹æ®éœ€è¦é€‰æ‹©
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡å‘é‡ç¼–ç ï¼Œæé«˜æ„å»ºé€Ÿåº¦
- **å†…å­˜ç®¡ç†**: æµå¼å¤„ç†å¤§æ–‡æ¡£ï¼Œé¿å…å†…å­˜æº¢å‡º
- **ç¼“å­˜æœºåˆ¶**: æ™ºèƒ½æ£€æµ‹å†…å®¹å˜åŒ–ï¼Œåªé‡æ–°ç´¢å¼•å˜æ›´éƒ¨åˆ†

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç´¢å¼•æ„å»ºå¤±è´¥**
   ```bash
   # æ£€æŸ¥å†…å®¹ç›®å½•
   ls content/

   # æ£€æŸ¥æƒé™
   chmod +r content/
   ```

2. **æŸ¥è¯¢æ— ç»“æœ**
   ```bash
   # é‡å»ºç´¢å¼•
   python rag_engine.py --rebuild-index

   # æ£€æŸ¥æŸ¥è¯¢å…³é”®è¯
   python rag_engine.py --query "å…·ä½“çš„æŠ€æœ¯æœ¯è¯­"
   ```

3. **OpenAI APIé”™è¯¯**
   ```bash
   # æ£€æŸ¥APIå¯†é’¥
   export OPENAI_API_KEY="sk-..."

   # æ£€æŸ¥ç½‘ç»œè¿æ¥
   curl -I https://api.openai.com
   ```

4. **å†…å­˜ä¸è¶³**
   ```bash
   # ä½¿ç”¨æ›´å°çš„æ¨¡å‹
   python rag_engine.py --embedding-model "all-MiniLM-L6-v2"

   # å‡å°‘æ‰¹é‡å¤§å°
   # åœ¨ä»£ç ä¸­è°ƒæ•´batch_sizeå‚æ•°
   ```

## æŠ€æœ¯ç»†èŠ‚

### æ”¯æŒçš„åµŒå…¥æ¨¡å‹

- **all-MiniLM-L6-v2**: å¿«é€Ÿï¼Œ384ç»´ï¼Œé»˜è®¤é€‰æ‹©
- **all-mpnet-base-v2**: é«˜ç²¾åº¦ï¼Œ768ç»´ï¼Œæ›´å‡†ç¡®ä½†è¾ƒæ…¢
- **paraphrase-multilingual-MiniLM-L12-v2**: å¤šè¯­è¨€æ”¯æŒ

### å‘é‡ç´¢å¼•

- **IndexFlatIP**: å†…ç§¯ç´¢å¼•ï¼Œç²¾ç¡®ä½†å†…å­˜å ç”¨å¤§
- **IndexIVFFlat**: è¿‘ä¼¼ç´¢å¼•ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œå†…å­˜æ›´å°‘
- **IndexHNSW**: å›¾ç´¢å¼•ï¼Œæœ€å¿«çš„è¿‘ä¼¼æœç´¢

### ç›¸ä¼¼åº¦è®¡ç®—

- ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ (cosine similarity)
- æ”¯æŒå¤šç§è·ç¦»åº¦é‡ï¼šL2ã€IP (å†…ç§¯)
- å¯é…ç½®ç›¸ä¼¼åº¦é˜ˆå€¼è¿‡æ»¤ç»“æœ

## æœªæ¥æ‰©å±•

- **å¤šæ¨¡æ€æ”¯æŒ**: æ”¯æŒå›¾ç‰‡ã€ä»£ç ç‰‡æ®µçš„æ£€ç´¢
- **å®æ—¶ç´¢å¼•**: è‡ªåŠ¨æ£€æµ‹å†…å®¹å˜åŒ–å¹¶æ›´æ–°ç´¢å¼•
- **å¯¹è¯å†å²**: ç»´æŠ¤å¯¹è¯ä¸Šä¸‹æ–‡æä¾›æ›´è¿è´¯çš„å›ç­”
- **å¤šç§Ÿæˆ·**: æ”¯æŒå¤šä¸ªåšå®¢çš„ç‹¬ç«‹ç´¢å¼•
- **APIæ¥å£**: æä¾›RESTful APIä¾›ç¬¬ä¸‰æ–¹é›†æˆ

## è®¸å¯è¯

MIT License


